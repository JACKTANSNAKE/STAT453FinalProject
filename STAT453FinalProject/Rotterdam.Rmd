---
title: "Rotterdam"
author: "JACK TAN, YIMING MIAO"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: 
  bookdown::pdf_book: default
  bookdown::gitbook: default
documentclass: book
classoption: openany
---

# Motivation

According to World Health Organization$*$, Cancer is a leading cause of death worldwide, accounting for an estimated 9.6 million deaths in 2018. And amongst all cancer types, breast cancer(along with lung cancer) has the top cases of death: 2.09 million cases in 2018. According to the CDC$*$, Breast cancer is also the second most common cancer among women in the United States, comprising 22.9% of invasive cancers in women and 16% of all female cancers. However, because of the cancer's characteristics, breast cancer patients have relatively high 5-year survival rate of 85% compared to other more lethal cancers according to research conducted in the UK$*$. We think it is worthwhile to look at the relationship between survival/recurrence time and some diagnostic criterion. We are also going to explore the effect of different treatments on survival/recurrence.

## Some Background Information

For doctors to be able to assess the severity and different types of breast cancer, researchers have come up with a diagnosing system called the TNM$*$ Staging system that is widely used in the diagnostics of breast cancer:

**Tumor(T)**: How large is the primary tumor in the breast? 

**Node (N)**: Has the tumor spread to the lymph nodes? If so, where, what size, and how many?

**Metastasis (M)**: Has the cancer spread to other parts of the body?

Generally, the results from the above three features are combined to form a diagnosis of a total of 5 stages of breast cancer: stage 0 (zero), which is non-invasive ductal carcinoma in situ (DCIS), and stages I through IV (1 through 4), which are used for invasive breast cancer.

We will be using data related to this system, especially Tumor and Node(since metastasis is often not recorded in datasets), to conduct our exploration.




<!--chapter:end:index.Rmd-->

# Data Exploration

```{r include=FALSE}
# automatically create a bib database for R packages
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown', 'survival', 'survminer', 'ggplot2', 'caret', 'hrbrthemes', 'viridis'
), 'packages.bib')
```

```{r, echo=FALSE,warning=FALSE,message=FALSE,include=FALSE}
library(survival)
library(survminer)
library(tidyverse)
library(caret)
library(hrbrthemes)
library(viridis)
```

## Loading Data
```{r}
data(rotterdam)
```

The data that we are going to use is called `rotterdam`, and it is a dataset that's pre-recorded in the survival package. According to the documentation of the package, the data are retrieved from the Rotterdam tumor bank, which include various anonymous information about patients with breast cancer. Below is a table of the variables in the dataset:

Variable name         |      Description
----------------------|---------------------------------------------------------
`pid`                 |      patient identifier
`year`                |      year of cancer incidence
`age`                 |      age
`meno`                |      menopausal status (0= premenopausal, 1= postmenopausal)
`size`                |      tumor size, a factor with levels `<=20`, `20-50`, `>50`
`grade`               |      tumor grade
`nodes`               |      number of positive lymph nodes
`pgr`                 |      progesterone receptors (fmol/l)
`er`                  |      estrogen receptors (fmol/l)
`hormon`              |      hormonal treatment (0=no, 1=yes)
`chemo`               |      chemotherapy
`rtime`               |      days to recurrence or last follow-up
`recur`               |      0= no recurrence, 1= recurrence
`dtime`               |      days to death or last follow-up
`death`               |      0= alive, 1= dead

From the description above, we see that there are `size` which stands for the size of the tumor, `nodes` which stands for how many lymph nodes are test cancer positive, so we have 2 criterions out of the three suggested in the background info.

## Data Wrangling

```{r}
rotterdam %>% 
  group_by(size) %>%
  summarise(number = n(), .groups = 'drop')
```

For lymph nodes, the usual way of classifying the severity would be:`N0` for no positive nodes; `N1` for 1-3 positive nodes; `N2` for  4-9 positive nodes; and `N3` for more than 10 nodes. We will follow this classification and make a new factor called `Nodes_level`

```{r}
rotterdam <- rotterdam %>% 
  mutate(Nodes_level = ifelse(nodes == 0, "N0", 
                              ifelse(nodes >= 1 & nodes <= 3, "N1", 
                                     ifelse(nodes >= 4 & nodes <= 9, "N2", 
                                            ifelse(nodes >= 10, "N3", NaN)))))
rotterdam %>% 
  group_by(Nodes_level) %>%
  summarise(number = n(), .groups = 'drop')
```

Since the `grade` variable in our dataset is a numeric variable whereas we actually want to treat it as a factor, we do the following:

```{r}
rotterdam <- rotterdam %>%
  mutate(grade = as.factor(grade))
```

As we were examining through the data, we found that upon the `chemo` variable and the `hormon` variable, there are instances where patients gets both therapy or neither. So in order to explore the relationship between treatment and survival, we introduce a new variable called `Treatment`, using the `chemo` and `hormon` variables.

```{r}
rotterdam <- rotterdam %>%
  mutate(Treatment = ifelse(chemo == 1 & hormon == 0, "Chemo", ifelse(chemo == 0 & hormon == 1, "Hormon", ifelse(chemo == 1 & hormon == 1, "Both", "NaN/Other Treatment"))))
```

## Data visualizations and exploration

### Diagnostics vs. Survival Times

`size` vs. `dtime`
```{r}
ggplot(data = rotterdam, aes(x = size, y = dtime, fill = size)) +
  geom_violin(alpha = 0.7)
```

`size` vs. `rtime`
```{r}
ggplot(data = rotterdam, aes(x = size, y = rtime, fill = size)) +
  geom_violin(alpha = 0.7)
```

As we can see from the two plots above, tumor size could be an important factor that affects patients' survival time and recur time. For `size` smaller than 20, most of the patients are able to survive or encounter recurrence after roughly 3000 days. But for `size` 20-50 and >50, it's highly likely for breast cancer to recur in 500 days.

`Nodes_level` vs. `dtime`
```{r}
ggplot(data = rotterdam, aes(x = Nodes_level, y = dtime, fill = Nodes_level)) +
  geom_violin(alpha = 0.7)
```

`Nodes_level` vs. `rtime`
```{r}
ggplot(data = rotterdam, aes(x = Nodes_level, y = rtime, fill = Nodes_level)) +
  geom_violin(alpha = 0.7)
```

Similarly, `nodes` is also a factor impacting the life of breast cancer patients. For patients with `Nodes_level` N2 and N3, a quite large proportion of them fail to survival more than 1000 days and encounter recurrence in less than 500 days.

### Treatment vs. Survival Times

`Treatment` vs. `dtime`
```{r}
ggplot(data = rotterdam, aes(x = Treatment, y = dtime, fill = Treatment)) +
  geom_violin(alpha = 0.7)
```

`Treatment` vs. `rtime`
```{r}
ggplot(data = rotterdam, aes(x = Treatment, y = rtime, fill = Treatment)) +
  geom_violin(alpha = 0.7)
```

By examing the two plots above, it seems that `Treatment` would not affect patients survival time or recurrence that much. We can find that `chemo + hormon` is likely to be the one with best curative effect, that patients receiving both chemo and hormon therapy tend to have longer survival time and longer time to recurrence. And the effect of hormon therapy itself seems not that satisfying. 

We also found a bi-model shape in `NaN/Other Traetment` group. This may because the two peaks correponds to no treatment and other treatment separately, but currently we don't more information investigating the true reason.

A very important criterion in analysis about cancer is the 5-year survival rate. In order to examine that, we introduce a new variable called `5_year_survival`, which indicates 1 if a patients survival time is larger than 5 years and 0 vice versa.

```{r}
rotterdam <- rotterdam %>%
  mutate(dtime_Years = floor(dtime/365)) %>%
  mutate(`5_year_survival` = ifelse(dtime_Years >= 5, 1, 0))
```

Now we want to calculate the 5-year survival rate for the population in the dataset.

```{r}
rotterdam %>% 
  group_by(`5_year_survival`) %>%
  summarise(number = n(), .groups = 'drop')

2084/(898+2084)
```

And also the important 10-year survival rate.

```{r}
rotterdam <- rotterdam %>%
  mutate(dtime_Years = floor(dtime/365)) %>%
  mutate(`10_year_survival` = ifelse(dtime_Years >= 10, 1, 0))
```

Now we calculate the 10-year survival rate for the population in the dataset.

```{r}
rotterdam %>% 
  group_by(`10_year_survival`) %>%
  summarise(number = n(), .groups = 'drop')

685/(685 + 2297)
```

We can find that the 5-year survival rate for breast cancer is just fine, and around 70% of patients are able to live more than 5 years. However, the 10-year survival rate is still disappointing given the current medical level, and only around 20% patients could live more than 10 years after diagnosis. 

All above information reminds people, especially females, that screening does save lives. Get screening and diagnosis earlier could greatly help improving the quality of life in the future. 











<!--chapter:end:02_DataExploration.Rmd-->

# Survival

```{r, echo=FALSE,warning=FALSE,message=FALSE,include=FALSE}
library(survival)
library(survminer)
library(tidyverse)
library(caret)
library(hrbrthemes)
library(viridis)
```

## Loading Data
```{r}
data(rotterdam)
```

```{r, echo=FALSE,warning=FALSE,message=FALSE,include=FALSE}
rotterdam <- rotterdam %>%
  mutate(Treatment = ifelse(chemo == 1 & hormon == 0, "Chemo", ifelse(chemo == 0 & hormon == 1, "Hormon", ifelse(chemo == 1 & hormon == 1, "Both", "NaN/Other Treatment"))))
rotterdam <- rotterdam %>% 
  mutate(Nodes_level = ifelse(nodes == 0, "N0", 
                              ifelse(nodes >= 1 & nodes <= 3, "N1", 
                                     ifelse(nodes >= 4 & nodes <= 9, "N2", 
                                            ifelse(nodes >= 10, "N3", NaN)))))
rotterdam <- rotterdam %>%
  mutate(grade = as.factor(grade))
```

## Kaplan-Miere

### `size` vs. Survival Times

`size` vs. `dtime`
```{r}
KM_None_Death <- survfit(Surv(dtime, death) ~ size, data = rotterdam)
plot(KM_None_Death, conf.type = "plain", col = c("blue","red","purple"), xlab="Days", ylab="Survival", lty = 1:3)
```

`size` vs. `rtime`
```{r}
KM_None_Recur <- survfit(Surv(rtime, recur) ~ size, data = rotterdam)
plot(KM_None_Recur, conf.type = "plain", col = c("blue","red","purple"), xlab="Days", ylab="Survival", lty = 1:3)
```

### `Nodes_level` vs. Survival Times

`size` vs. `dtime`
```{r}
KM_None_Death <- survfit(Surv(dtime, death) ~ Nodes_level, data = rotterdam)
plot(KM_None_Death, conf.type = "plain", col = c("blue","red","purple","green"), xlab="Days", ylab="Survival", lty = 1:4)
```

`size` vs. `rtime`
```{r}
KM_None_Recur <- survfit(Surv(rtime, recur) ~ Nodes_level, data = rotterdam)
plot(KM_None_Recur, conf.type = "plain", col = c("blue","red","purple", "green"), xlab="Days", ylab="Survival", lty = 1:4)
```

### `Treatment` vs. Survival Times

`Treatment` vs. `dtime`
```{r warning=FALSE}
KM_Treatment_Death <- survfit(Surv(dtime, death) ~ Treatment, data = rotterdam)
plot(KM_Treatment_Death, conf.int = FALSE, col = c("blue", "red", "purple", "green"), xlab="Days", ylab="Survival", lty=1:4)
legend(1, 0.4, legend=c("Both", "Chemo","Hormon", "NaN/Other Treatment"),
       col=c("blue", "red", "purple", "green"), lty=1:4, cex=0.8,
       title="Treatment Group", text.font=6)
```

`Treatment` vs. `rtime`
```{r}
KM_Treatment_Recur <- survfit(Surv(rtime, recur) ~ Treatment, data = rotterdam)
plot(KM_Treatment_Recur, conf.int = FALSE, col = c("blue", "red", "purple", "green"), xlab="Days", ylab="Survival", lty=1:4)
legend(1, 0.4, legend=c("Both", "Chemo","Hormon", "NaN/Other Treatment"),
       col=c("blue", "red", "purple", "green"), lty=1:4, cex=0.8,
       title="Treatment Group", text.font=6)
```

## Parametric Models 

```{r}
### Introduce the CoxSnell residuals for parametric model assessment
CoxSnell = function(cs,status,xlim=NULL,ylim=NULL)
{
kmcs = survfit( Surv(jitter(cs,amount=(max(cs)-min(cs))/1000),status) ~ 1 )$surv

plot( log(-log(kmcs)) ~ sort(log(cs)) ,
      xlab="log(Cox-Snell)", ylab="log(-log(S(Cox-Snell)))", xlim=xlim, ylim=ylim )

abline(0,1,col='red')
}
```

### Diagnostics vs. Survival Times

Exponential model:
```{r}
DexpFactoredNodes <- survreg(Surv(dtime, death) ~ size + Nodes_level, dist='exponential', data=rotterdam)
DexpNumericNodes <- survreg(Surv(dtime, death) ~ size + nodes, dist='exponential', data=rotterdam)
DexpFactoredNodes
DexpNumericNodes
```

```{r}
CSFactored <- -log(1 - pexp(rotterdam$dtime, 1/exp(9.4580834-0.4079558*ifelse(rotterdam$size=="20-50",1,0)-0.7156137*ifelse(rotterdam$size==">50",1,0)-0.5001880*ifelse(rotterdam$Nodes_level=="N1",1,0)-0.9946036*ifelse(rotterdam$Nodes_level=="N2",1,0)-1.3062361*ifelse(rotterdam$Nodes_level=="N3",1,0))))
# Make appropriate graph using CoxSnell function
CoxSnell(CSFactored, rotterdam$death)

CSNumeric <- -log(1 - pexp(rotterdam$dtime, 1/exp(9.25807238-0.48559190*ifelse(rotterdam$size=="20-50",1,0)-0.87914002*ifelse(rotterdam$size==">50",1,0)-0.07094178*rotterdam$nodes)))
# Make appropriate graph using CoxSnell function
CoxSnell(CSNumeric, rotterdam$death)
```

Weibull model:
```{r}
DweibullFactoredNodes <- survreg(Surv(dtime, death) ~ size + Nodes_level, dist='weibull', data=rotterdam)
DweibullNumericNodes <- survreg(Surv(dtime, death) ~ size + nodes, dist='weibull', data=rotterdam)
DweibullFactoredNodes
DweibullNumericNodes
```

```{r}
CSFactored <- -log(1 - pweibull(rotterdam$dtime, 1/0.7423267, exp(9.1139316-0.3138368*ifelse(rotterdam$size=="20-50",1,0)-0.5771036*ifelse(rotterdam$size==">50",1,0)-0.3840287*ifelse(rotterdam$Nodes_level=="N1",1,0)-0.7862627*ifelse(rotterdam$Nodes_level=="N2",1,0)-1.0530855*ifelse(rotterdam$Nodes_level=="N3",1,0))))
# Make appropriate graph using CoxSnell function
CoxSnell(CSFactored, rotterdam$death)

CSNumeric <- -log(1 - pweibull(rotterdam$dtime, 1/0.748139, exp(8.96551068-0.37327053*ifelse(rotterdam$size=="20-50",1,0)-0.71478411*ifelse(rotterdam$size==">50",1,0)-0.05733795*rotterdam$nodes)))
# Make appropriate graph using CoxSnell function
CoxSnell(CSNumeric, rotterdam$death)
```

Log-normal model:
```{r}
DlnormFactoredNodes <- survreg(Surv(dtime, death) ~ size + Nodes_level, dist='lognormal', data=rotterdam)
DlnormNumericNodes <- survreg(Surv(dtime, death) ~ size + nodes, dist='lognormal', data=rotterdam)
DlnormFactoredNodes
DlnormNumericNodes
```

```{r}
CSFactored <- -log(1 - plnorm(rotterdam$dtime,   8.8734197-0.3292566*ifelse(rotterdam$size=="20-50",1,0)-0.6043081*ifelse(rotterdam$size==">50",1,0) -0.4020603*ifelse(rotterdam$Nodes_level=="N1",1,0)-0.8575354*ifelse(rotterdam$Nodes_level=="N2",1,0)-1.1966395*ifelse(rotterdam$Nodes_level=="N3",1,0), 1.070683))
# Make appropriate graph using CoxSnell function
CoxSnell(CSFactored, rotterdam$death)

CSNumeric <- -log(1 - plnorm(rotterdam$dtime, 8.75960765 - 0.38390034*ifelse(rotterdam$size=="20-50",1,0)-0.70016258*ifelse(rotterdam$size==">50",1,0) -0.07917648*rotterdam$nodes, 1.08368))

CoxSnell(CSNumeric, rotterdam$death)
```

### Diagnostics vs. Recurrence Times

Exponential model:
```{r}
DexpFactoredNodes <- survreg(Surv(rtime, recur) ~ size + Nodes_level, dist='exponential', data=rotterdam)
DexpNumericNodes <- survreg(Surv(rtime, recur) ~ size + nodes, dist='exponential', data=rotterdam)
DexpFactoredNodes
DexpNumericNodes
```

```{r}
CSFactored <- -log(1 - pexp(rotterdam$rtime, 1/exp(8.9222448-0.3234604*ifelse(rotterdam$size=="20-50",1,0)-0.5439809*ifelse(rotterdam$size==">50",1,0)-0.3714043*ifelse(rotterdam$Nodes_level=="N1",1,0)-0.9934901*ifelse(rotterdam$Nodes_level=="N2",1,0)-1.4131380*ifelse(rotterdam$Nodes_level=="N3",1,0))))
# Make appropriate graph using CoxSnell function
CoxSnell(CSFactored, rotterdam$recur)

CSNumeric <- -log(1 - pexp(rotterdam$rtime, 1/exp(8.78007732 -0.39027711*ifelse(rotterdam$size=="20-50",1,0)-0.68814113*ifelse(rotterdam$size==">50",1,0)-0.08100318*rotterdam$nodes)))
# Make appropriate graph using CoxSnell function
CoxSnell(CSNumeric, rotterdam$recur)
```

Weibull model:
```{r}
DweibullFactoredNodes <- survreg(Surv(rtime, recur) ~ size + Nodes_level, dist='weibull', data=rotterdam)
DweibullNumericNodes <- survreg(Surv(rtime, recur) ~ size + nodes, dist='weibull', data=rotterdam)
DweibullFactoredNodes
DweibullNumericNodes
```

```{r}
CSFactored <- -log(1 - pweibull(rotterdam$rtime, 1/1.008247, exp(8.9297745-0.3256748*ifelse(rotterdam$size=="20-50",1,0)-0.5464318*ifelse(rotterdam$size==">50",1,0)-0.3737779*ifelse(rotterdam$Nodes_level=="N1",1,0)-0.9991092*ifelse(rotterdam$Nodes_level=="N2",1,0)-1.4204576*ifelse(rotterdam$Nodes_level=="N3",1,0))))
# Make appropriate graph using CoxSnell function
CoxSnell(CSFactored, rotterdam$recur)

CSNumeric <- -log(1 - pweibull(rotterdam$rtime, 1/1.018449, exp(8.79497805-0.39619564*ifelse(rotterdam$size=="20-50",1,0)-0.69507535*ifelse(rotterdam$size==">50",1,0)-0.08199745*rotterdam$nodes)))
# Make appropriate graph using CoxSnell function
CoxSnell(CSNumeric, rotterdam$recur)
```

Log-normal model:
```{r}
DlnormFactoredNodes <- survreg(Surv(rtime, recur) ~ size + Nodes_level, dist='lognormal', data=rotterdam)
DlnormNumericNodes <- survreg(Surv(rtime, recur) ~ size + nodes, dist='lognormal', data=rotterdam)
DlnormFactoredNodes
DlnormNumericNodes
```

```{r}
CSFactored <- -log(1 - plnorm(rotterdam$rtime,   8.5287301-0.3990732*ifelse(rotterdam$size=="20-50",1,0)-0.6058651*ifelse(rotterdam$size==">50",1,0) -0.3437357*ifelse(rotterdam$Nodes_level=="N1",1,0)-0.9944863*ifelse(rotterdam$Nodes_level=="N2",1,0)-1.4794706*ifelse(rotterdam$Nodes_level=="N3",1,0), 1.335044))
# Make appropriate graph using CoxSnell function
CoxSnell(CSFactored, rotterdam$recur)

CSNumeric <- -log(1 - plnorm(rotterdam$rtime, 8.4375379 - 0.4427015*ifelse(rotterdam$size=="20-50",1,0)-0.6916485*ifelse(rotterdam$size==">50",1,0) -0.1014937*rotterdam$nodes, 1.08368))

CoxSnell(CSNumeric, rotterdam$recur)
```

### Treatment vs. Survival Times

Exponential model:
```{r}
Dexp <- survreg(Surv(dtime, death) ~ Treatment, dist='exponential', data=rotterdam)
Dexp
```

```{r}
CS <- -log(1 - pexp(rotterdam$dtime, 1/exp(9.2675474-0.6178274*ifelse(rotterdam$Treatment=="TreatmentChemo",1,0)-0.9740923*ifelse(rotterdam$Treatment=="TreatmentHormon",1,0)-0.4801527*ifelse(rotterdam$Treatment=="TreatmentNaN/Other Treatment",1,0))))
# Make appropriate graph using CoxSnell function
CoxSnell(CS, rotterdam$death)
```

Weibull model:
```{r}
Dweibull <- survreg(Surv(dtime, death) ~ Treatment, dist='weibull', data=rotterdam)
Dweibull
```

```{r}
CS <- -log(1 - pweibull(rotterdam$dtime, 1/0.7853686, exp(9.0256920-0.5087149*ifelse(rotterdam$Treatment=="TreatmentChemo",1,0)-0.8529757*ifelse(rotterdam$Treatment=="TreatmentHormon",1,0)-0.3952678*ifelse(rotterdam$Treatment=="TreatmentNaN/Other Treatment",1,0))))
# Make appropriate graph using CoxSnell function
CoxSnell(CS, rotterdam$death)
```

Log-normal model:
```{r}
Dlnorm <- survreg(Surv(dtime, death) ~ Treatment, dist='lognormal', data=rotterdam)
Dlnorm
```

```{r}
CS <- -log(1 - plnorm(rotterdam$dtime,   8.7552607-0.4988799*ifelse(rotterdam$Treatment=="TreatmentChemo",1,0)-0.8119019*ifelse(rotterdam$Treatment=="TreatmentHormon",1,0) -0.3782626*ifelse(rotterdam$Treatment=="TreatmentNaN/Other Treatment",1,0), 1.193984))
# Make appropriate graph using CoxSnell function
CoxSnell(CS, rotterdam$death)
```

### Treatment vs. Survival Times

Exponential model:
```{r}
Dexp <- survreg(Surv(rtime, recur) ~ Treatment, dist='exponential', data=rotterdam)
Dexp
```

```{r}
CS <- -log(1 - pexp(rotterdam$rtime, 1/exp(8.6387571-0.4806280*ifelse(rotterdam$Treatment=="TreatmentChemo",1,0)-0.6736760*ifelse(rotterdam$Treatment=="TreatmentHormon",1,0)-0.2245649*ifelse(rotterdam$Treatment=="TreatmentNaN/Other Treatment",1,0))))
# Make appropriate graph using CoxSnell function
CoxSnell(CS, rotterdam$recur)
```

Weibull model:
```{r}
Dweibull <- survreg(Surv(rtime, recur) ~ Treatment, dist='weibull', data=rotterdam)
Dweibull
```

```{r}
CS <- -log(1 - pweibull(rotterdam$dtime, 1/1.081885, exp(8.6886491-0.5055531*ifelse(rotterdam$Treatment=="TreatmentChemo",1,0)-0.6910078*ifelse(rotterdam$Treatment=="TreatmentHormon",1,0)-0.2332029*ifelse(rotterdam$Treatment=="TreatmentNaN/Other Treatment",1,0))))
# Make appropriate graph using CoxSnell function
CoxSnell(CS, rotterdam$recur)
```

Log-normal model:
```{r}
Dlnorm <- survreg(Surv(rtime, recur) ~ Treatment, dist='lognormal', data=rotterdam)
Dlnorm
```

```{r}
CS <- -log(1 - plnorm(rotterdam$rtime,   8.3190087-0.5373331*ifelse(rotterdam$Treatment=="TreatmentChemo",1,0)-0.6984793*ifelse(rotterdam$Treatment=="TreatmentHormon",1,0) -0.3175542*ifelse(rotterdam$Treatment=="TreatmentNaN/Other Treatment",1,0), 1.490703))
# Make appropriate graph using CoxSnell function
CoxSnell(CS, rotterdam$recur)
```

## Cox-PH

```{r}
KM = survfit(Surv(dtime, death) ~ Treatment, data = rotterdam)

# Note the fun='cloglog' parameter:
plot( KM , fun='cloglog', mark.time=FALSE, lty=1:4, col = c("blue", "red", "purple", "green"))
```



<!--chapter:end:03_Survival.Rmd-->

# Reference

* “Breast Cancer - Stages.” Cancer.Net, 14 Aug. 2020, www.cancer.net/cancer-types/breast-cancer/stages#:~:text=There are 5 stages of,to plan the best treatments.

* “Breast Cancer Statistics.” Centers for Disease Control and Prevention, Centers for Disease Control and Prevention, 8 June 2020, www.cdc.gov/cancer/breast/statistics/index.htm.

* “Breast Cancer Survival Statistics.” Cancer Research UK, 22 Jan. 2021, www.cancerresearchuk.org/health-professional/cancer-statistics/statistics-by-cancer-type/breast-cancer/survival#heading-Zero.

* “Cancer.” World Health Organization, World Health Organization, www.who.int/news-room/fact-sheets/detail/cancer.

<!--chapter:end:Reference.Rmd-->

