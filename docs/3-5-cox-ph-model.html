<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="3.5 Cox-PH model: | Rotterdam" />
<meta property="og:type" content="book" />





<meta name="author" content="JACK TAN, YIMING MIAO" />

<meta name="date" content="2021-03-12" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="3.5 Cox-PH model: | Rotterdam">

<title>3.5 Cox-PH model: | Rotterdam</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#motivation"><span class="toc-section-number">1</span> Motivation</a><ul>
<li><a href="1-1-some-background-information.html#some-background-information"><span class="toc-section-number">1.1</span> Some Background Information</a></li>
</ul></li>
<li class="has-sub"><a href="2-data-exploration.html#data-exploration"><span class="toc-section-number">2</span> Data Exploration</a><ul>
<li><a href="2-1-loading-data.html#loading-data"><span class="toc-section-number">2.1</span> Loading Data</a></li>
<li class="has-sub"><a href="2-2-data-wrangling.html#data-wrangling"><span class="toc-section-number">2.2</span> Data Wrangling</a><ul>
<li><a href="2-2-data-wrangling.html#ttumornnodemmetastasis"><span class="toc-section-number">2.2.1</span> T(Tumor)N(Node)M(Metastasis)</a></li>
<li><a href="2-2-data-wrangling.html#treatment"><span class="toc-section-number">2.2.2</span> Treatment</a></li>
</ul></li>
<li class="has-sub"><a href="2-3-data-visualizations-and-exploration.html#data-visualizations-and-exploration"><span class="toc-section-number">2.3</span> Data visualizations and exploration</a><ul>
<li><a href="2-3-data-visualizations-and-exploration.html#diagnostics-vs.-survival-times"><span class="toc-section-number">2.3.1</span> Diagnostics vs. Survival Times</a></li>
<li><a href="2-3-data-visualizations-and-exploration.html#treatment-vs.-survival-times"><span class="toc-section-number">2.3.2</span> Treatment vs. Survival Times</a></li>
<li><a href="2-3-data-visualizations-and-exploration.html#age-treatment-vs.-survival-times"><span class="toc-section-number">2.3.3</span> <code>age</code> + <code>Treatment</code> vs. Survival Times</a></li>
<li><a href="2-3-data-visualizations-and-exploration.html#treatment-vs.-tnm"><span class="toc-section-number">2.3.4</span> <code>Treatment</code> vs. TNM</a></li>
<li><a href="2-3-data-visualizations-and-exploration.html#general-x-year-survival-rate"><span class="toc-section-number">2.3.5</span> General X-year Survival Rate</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="3-survival.html#survival"><span class="toc-section-number">3</span> Survival</a><ul>
<li><a href="3-1-loading-data-1.html#loading-data-1"><span class="toc-section-number">3.1</span> Loading Data</a></li>
<li><a href="3-2-kaplan-miere-estimator-of-the-entire-dataset.html#kaplan-miere-estimator-of-the-entire-dataset"><span class="toc-section-number">3.2</span> Kaplan-Miere estimator of the entire dataset</a></li>
<li class="has-sub"><a href="3-3-kaplan-miere-estimator-on-different-variables-in-rotterdam.html#kaplan-miere-estimator-on-different-variables-in-rotterdam"><span class="toc-section-number">3.3</span> Kaplan-Miere estimator on different variables in <code>rotterdam</code></a><ul>
<li><a href="3-3-kaplan-miere-estimator-on-different-variables-in-rotterdam.html#size-vs.-survival-times"><span class="toc-section-number">3.3.1</span> <code>size</code> vs. Survival Times</a></li>
<li><a href="3-3-kaplan-miere-estimator-on-different-variables-in-rotterdam.html#nodes_level-vs.-survival-times"><span class="toc-section-number">3.3.2</span> <code>Nodes_level</code> vs. Survival Times</a></li>
<li><a href="3-3-kaplan-miere-estimator-on-different-variables-in-rotterdam.html#treatment-vs.-survival-times-1"><span class="toc-section-number">3.3.3</span> <code>Treatment</code> vs. Survival Times</a></li>
</ul></li>
<li class="has-sub"><a href="3-4-parametric-models.html#parametric-models"><span class="toc-section-number">3.4</span> Parametric Models</a><ul>
<li><a href="3-4-parametric-models.html#user-defined-cox-snell-function"><span class="toc-section-number">3.4.1</span> User-defined Cox-Snell function</a></li>
<li><a href="3-4-parametric-models.html#exponential-models"><span class="toc-section-number">3.4.2</span> Exponential models</a></li>
<li><a href="3-4-parametric-models.html#weibull-models"><span class="toc-section-number">3.4.3</span> Weibull models</a></li>
<li><a href="3-4-parametric-models.html#log-normal-models"><span class="toc-section-number">3.4.4</span> Log-normal models</a></li>
<li><a href="3-4-parametric-models.html#positive-coefficient-of-age"><span class="toc-section-number">3.4.5</span> Positive coefficient of <code>age</code></a></li>
</ul></li>
<li class="has-sub"><a href="3-5-cox-ph-model.html#cox-ph-model"><span class="toc-section-number">3.5</span> Cox-PH model:</a><ul>
<li><a href="3-5-cox-ph-model.html#dtime-coxph-model"><span class="toc-section-number">3.5.1</span> <code>dtime</code> coxph model</a></li>
</ul></li>
</ul></li>
<li class="has-sub"><a href="4-conclusion.html#conclusion"><span class="toc-section-number">4</span> Conclusion</a><ul>
<li><a href="4-1-limitation.html#limitation"><span class="toc-section-number">4.1</span> Limitation</a></li>
<li><a href="4-2-reference.html#reference"><span class="toc-section-number">4.2</span> Reference</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="cox-ph-model" class="section level2">
<h2><span class="header-section-number">3.5</span> Cox-PH model:</h2>
<p>Another very important part of a survival analysis is building and interpreting the coxph model. With this model, once we have proof of the validation of the PH assumption of the model, we could have nice coefficients to interpret as the logarithm of HR(hazard ratio) among different groups. We will be following the way that we built our parametric models, by using Survival times vs. <code>age</code> + <code>size</code> + <code>nodes</code> + <code>Treatment</code>.</p>
<div id="dtime-coxph-model" class="section level3">
<h3><span class="header-section-number">3.5.1</span> <code>dtime</code> coxph model</h3>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">m_death_withage =<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(dtime, death) <span class="op">~</span><span class="st"> </span>Treatment <span class="op">+</span><span class="st"> </span>size <span class="op">+</span><span class="st"> </span>nodes <span class="op">+</span><span class="st"> </span>age, <span class="dt">data=</span>rotterdam)</a>
<a class="sourceLine" id="cb81-2" title="2">m_death_withage</a></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(dtime, death) ~ Treatment + size + nodes + 
##     age, data = rotterdam)
## 
##                                  coef exp(coef) se(coef)      z        p
## TreatmentChemo               0.546830  1.727768 0.360076  1.519    0.129
## TreatmentHormon              0.519838  1.681756 0.366212  1.420    0.156
## TreatmentNaN/Other Treatment 0.496324  1.642672 0.356927  1.391    0.164
## size20-50                    0.477235  1.611612 0.065146  7.326 2.38e-13
## size&gt;50                      0.865167  2.375402 0.090893  9.519  &lt; 2e-16
## nodes                        0.074146  1.076964 0.004864 15.244  &lt; 2e-16
## age                          0.014904  1.015016 0.002562  5.818 5.94e-09
## 
## Likelihood ratio test=487.1  on 7 df, p=&lt; 2.2e-16
## n= 2982, number of events= 1272</code></pre>
<p>First we should check if the PH assumption holds. We will be using a formal test.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">cox.zph</span>(m_death_withage)</a></code></pre></div>
<pre><code>##           chisq df       p
## Treatment  4.45  3 0.21657
## size       4.81  2 0.09023
## nodes      3.32  1 0.06850
## age       15.12  1 0.00010
## GLOBAL    25.38  7 0.00065</code></pre>
<p>One of the variable, <code>age</code>, has p-value smaller than 0.05, which indicates the violation of the PH assumption. So we can not intepret the coefficients right away.</p>
<p>One way we came up to solve this problem is to put stratification on <code>age</code> by putting a <code>strata()</code> on <code>age</code> when fitting the model. What this does is to recognize the correlation between <code>age</code> and the <code>dtime</code>, but not actually including it in our model results.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">m_death_strataage =<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(dtime, death) <span class="op">~</span><span class="st"> </span>Treatment <span class="op">+</span><span class="st"> </span>size <span class="op">+</span><span class="st"> </span>nodes <span class="op">+</span><span class="st"> </span><span class="kw">strata</span>(age), <span class="dt">data=</span>rotterdam)</a>
<a class="sourceLine" id="cb85-2" title="2">m_death_strataage</a></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(dtime, death) ~ Treatment + size + nodes + 
##     strata(age), data = rotterdam)
## 
##                                  coef exp(coef) se(coef)      z        p
## TreatmentChemo               0.566734  1.762501 0.368984  1.536    0.125
## TreatmentHormon              0.571493  1.770909 0.375700  1.521    0.128
## TreatmentNaN/Other Treatment 0.497674  1.644890 0.365574  1.361    0.173
## size20-50                    0.464177  1.590704 0.066890  6.939 3.94e-12
## size&gt;50                      0.772204  2.164532 0.097352  7.932 2.16e-15
## nodes                        0.078158  1.081294 0.005365 14.567  &lt; 2e-16
## 
## Likelihood ratio test=391.7  on 6 df, p=&lt; 2.2e-16
## n= 2982, number of events= 1272</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="kw">cox.zph</span>(m_death_strataage)</a></code></pre></div>
<pre><code>##           chisq df    p
## Treatment  3.60  3 0.31
## size       4.32  2 0.12
## nodes      1.37  1 0.24
## GLOBAL     9.64  6 0.14</code></pre>
<p>Now we can see that all the variables’ p-value are greater than 0.05 which indicates the PH assumption holds in our model. Now we can finally intepret the coefficients.</p>
<p>For treatments, we can see that Chemotherapy, Hormontherapy and Other Treatment all have higher risks than patients receiving both therapies. However, note that all three p-values are greater than 0.05, which means that we do not have significant evidence for such relationships. We think that this is because there are too few data point receiving both therapies.</p>
<p>Now let’s look at tumor size. It is clear that patients with larger tumor size enjoy higher risks, and as the size grows, the risk is also increasing. such relationship is significant as we can see from the p-values since they are all less than 0.05.</p>
<p>For lymph nodes tested positive, we could see that for 1 unit increase in the number of nodes, the risk will increase by a multiplicative of 1.08. This relationship is also significant as the p-value is smaller than 0.05.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">m_recur =<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(rtime, recur) <span class="op">~</span><span class="st"> </span>Treatment <span class="op">+</span><span class="st"> </span>size <span class="op">+</span><span class="st"> </span>nodes <span class="op">+</span><span class="st"> </span>age, <span class="dt">data=</span>rotterdam)</a>
<a class="sourceLine" id="cb89-2" title="2">m_recur</a></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(rtime, recur) ~ Treatment + size + nodes + 
##     age, data = rotterdam)
## 
##                                   coef exp(coef)  se(coef)      z        p
## TreatmentChemo                0.324447  1.383266  0.283541  1.144 0.252512
## TreatmentHormon               0.436864  1.547846  0.290953  1.501 0.133227
## TreatmentNaN/Other Treatment  0.459422  1.583159  0.280366  1.639 0.101286
## size20-50                     0.399867  1.491626  0.057857  6.911 4.80e-12
## size&gt;50                       0.684610  1.982999  0.087589  7.816 5.44e-15
## nodes                         0.080239  1.083546  0.004575 17.539  &lt; 2e-16
## age                          -0.008653  0.991385  0.002314 -3.739 0.000184
## 
## Likelihood ratio test=429.7  on 7 df, p=&lt; 2.2e-16
## n= 2982, number of events= 1518</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="kw">cox.zph</span>(m_recur)</a></code></pre></div>
<pre><code>##            chisq df       p
## Treatment  7.943  3   0.047
## size      26.427  2 1.8e-06
## nodes      5.297  1   0.021
## age        0.104  1   0.747
## GLOBAL    42.374  7 4.4e-07</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">m_recur =<span class="st"> </span><span class="kw">coxph</span>(<span class="kw">Surv</span>(rtime, recur) <span class="op">~</span><span class="st"> </span><span class="kw">strata</span>(Treatment) <span class="op">+</span><span class="st"> </span>size <span class="op">+</span><span class="st"> </span>nodes <span class="op">+</span><span class="st"> </span>age, <span class="dt">data=</span>rotterdam)</a>
<a class="sourceLine" id="cb93-2" title="2">m_recur</a></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(rtime, recur) ~ strata(Treatment) + size + 
##     nodes + age, data = rotterdam)
## 
##                coef exp(coef)  se(coef)      z        p
## size20-50  0.396037  1.485924  0.057899  6.840 7.91e-12
## size&gt;50    0.693201  2.000107  0.087565  7.916 2.44e-15
## nodes      0.080220  1.083525  0.004576 17.529  &lt; 2e-16
## age       -0.008805  0.991233  0.002315 -3.804 0.000142
## 
## Likelihood ratio test=404.3  on 4 df, p=&lt; 2.2e-16
## n= 2982, number of events= 1518</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">cox.zph</span>(m_recur)</a></code></pre></div>
<pre><code>##          chisq df       p
## size   31.3790  2 1.5e-07
## nodes   9.8790  1  0.0017
## age     0.0979  1  0.7544
## GLOBAL 35.2423  4 4.1e-07</code></pre>

</div>
</div>
<!-- </div> -->
<p style="text-align: center;">
<a href="3-4-parametric-models.html"><button class="btn btn-default">Previous</button></a>
<a href="4-conclusion.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
